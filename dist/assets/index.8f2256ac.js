import{Q as g,a as d,b as u}from"./QCard.5ef509b0.js";import{g as n,G as m,s as h,a as f,_,c,b as a,w as l,d as o,o as p,e as b,Q as w,t as y,f as v,h as S}from"./index.59a2408f.js";import{U as $,D as V,K as C,Q as I,g as Q}from"./index.esm2017.3be222bc.js";import{_ as k}from"./login-house.25d18b4d.js";var E={name:"Login",data(){return{email:"",password:"",error:""}},methods:{async signIn(){try{const s=n(),e=new m,r=await h(s,e);console.log(r),this.fetchSubscription()}catch(s){console.log(s.message),alert("There was an issue logging into your account.  Please email support team.")}},async login(){try{const s=n(),e=await f(s,this.email,this.password);console.log({user:e}),this.fetchSubscription()}catch(s){s.message=="Firebase: Error (auth/user-not-found)."?alert("Email has not been registered."):s.message=="Firebase: Error (auth/wrong-password)."&&alert("Incorrect username or password.")}},async fetchSubscription(){this.isLoading=!0;const s=$(),e=V(s,"customers",n().currentUser.uid,"subscriptions"),r=C(e,I("status","in",["trialing","active","past_due","unpaid"]));this.subscription=await Q(r).then(i=>i.docs.length>0?i.docs[0].data():null),this.isLoading=!1,this.subscription==null?(console.log("You are NOT subscribed!!!"),alert("Your subscription has expired or has not started.  Redirecting to your Account page."),this.$router.replace({name:"Account"})):(console.log("You are subscribed!!!"),this.$store.commit("SET_ISSUBSCRIBED",!0),this.$router.replace({name:"Dashboard"}))}}};const U={class:"login"},P=o("img",{src:k,class:"house",rel:"preload"},null,-1),B=o("h2",{class:"form-title"},"Real Home Compare",-1),D=o("p",{class:"form-info"},"Please enter your login and password!",-1),A={class:"form_inputs"},N={class:"email",style:{"background-color":"white"}},R={class:"password",style:{"background-color":"white"}},F={class:"forgot-password"},L={class:"social-logins"},T=o("i",{class:"fab fa-google fa-lg"},null,-1),Y=[T],G={key:0,class:"error"},K={class:""},W=S(" Don't have an account? ");function H(s,e,r,i,M,O){return p(),c("section",U,[P,a(g,{class:"login-card text-white"},{default:l(()=>[a(d,null,{default:l(()=>[o("div",null,[o("form",{class:"login_form",onSubmit:e[4]||(e[4]=b((...t)=>s.login&&s.login(...t),["prevent"]))},[B,D,o("div",A,[o("div",N,[a(u,{filled:"",label:"Email",modelValue:s.email,"onUpdate:modelValue":e[0]||(e[0]=t=>s.email=t),type:"email",id:"login-email"},null,8,["modelValue"])]),o("div",R,[a(u,{filled:"",modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.password=t),type:"password",id:"login-password",label:"Password"},null,8,["modelValue"])])]),o("p",F,[o("a",{href:"#!",onClick:e[2]||(e[2]=t=>this.$router.replace({name:"ForgotPassword"}))},"Forgot password?")]),a(w,{outline:"",color:"white",class:"login-btn",label:"Login",type:"submit"}),o("div",L,[o("a",{href:"#!",onClick:e[3]||(e[3]=(...t)=>s.signIn&&s.signIn(...t))},Y)])],32),s.error?(p(),c("div",G,y(s.error.message)+" 1234",1)):v("",!0)])]),_:1}),a(d,null,{default:l(()=>[o("p",K,[W,o("a",{href:"#!",onClick:e[5]||(e[5]=t=>this.$router.replace({name:"Register"})),class:"signup"},"Sign Up")])]),_:1})]),_:1})])}var X=_(E,[["render",H]]);export{X as default};
