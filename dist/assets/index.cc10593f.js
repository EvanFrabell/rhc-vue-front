import{Q as S,a as R,b as p}from"./QCard.897520e0.js";import{g as c,a as V,G as P,s as Q,_ as k,o as h,c as w,b as i,w as _,d as s,e as C,Q as b,t as U,f as x,a6 as A,a7 as B}from"./index.87a63b34.js";import{B as m,V as u,U as y,K as v,w as f,T as E,E as I}from"./index.esm2017.9b81a962.js";var $={name:"Register",data(){return{email:"",password:"",passwordCopy:"",error:"",products:[],selectedPrice:"price_1Lat4VGrTucbD8SBxtUFHJR3",isLoading:!1}},methods:{async emailRegister(){try{const e=c(),o=await V(e,this.email,this.password);console.log({user:o}),this.fetchSubscription(),this.createSub()}catch(e){console.log(e.message)}},async googleRegister(){try{const e=c(),o=new P,t=await Q(e,o);console.log(t),this.fetchSubscription(),this.createSub()}catch(e){console.log(e.message)}},async fetchSubscription(){this.isLoading=!0;const e=m(),o=u(e,"customers",c().currentUser.uid,"subscriptions"),t=y(o,v("status","in",["trialing","active","past_due","unpaid"]));this.subscription=await f(t).then(n=>n.docs.length>0?n.docs[0].data():null),this.subscription==null?(console.log("You are NOT subscribed!!!"),this.fetchProducts()):console.log("You are already subscribed!!!")},async fetchProducts(){const e=m(),o=u(e,"products"),t=y(o,v("active","==",!0));(await f(t)).forEach(async r=>{const l=u(e,"products",r.id,"prices"),a=await f(l);this.products.push({id:r.id,...r.data(),prices:a.docs.map(g=>({id:g.id,...g.data()}))})})},async createSub(){const e=m(),o=u(e,"customers",c().currentUser.uid,"checkout_sessions"),t=await E(o,{price:this.selectedPrice,success_url:window.location.origin,cancel_url:window.location.origin});I(t,n=>{const{error:r,url:l}=n.data();r&&(console.error(`An error occured: ${r.message}`),this.isLoading=!1),l&&window.location.assign(l)})}}};const d=e=>(A("data-v-78ea3ef6"),e=e(),B(),e),G={class:"register"},L=d(()=>s("h2",{class:"form-title"},"$5/Month All Access Subscription",-1)),N=d(()=>s("p",{class:"form-info"},"Please fill in registration form!",-1)),T={class:"form_inputs"},z={class:"email",style:{"background-color":"white"}},D={class:"password",style:{"background-color":"white"}},K=d(()=>s("br",null,null,-1)),M={class:"password-copy",style:{"background-color":"white"}},O=d(()=>s("br",null,null,-1)),W=d(()=>s("p",null,"OR",-1)),Y={key:0,class:"error"};function j(e,o,t,n,r,l){return h(),w("section",G,[i(S,{class:"login-card text-white"},{default:_(()=>[i(R,null,{default:_(()=>[s("div",null,[s("form",{class:"login_form",onSubmit:o[3]||(o[3]=C((...a)=>e.emailRegister&&e.emailRegister(...a),["prevent"]))},[L,N,s("div",T,[s("div",z,[i(p,{filled:"",label:"Email",modelValue:e.email,"onUpdate:modelValue":o[0]||(o[0]=a=>e.email=a),type:"email",id:"login-email"},null,8,["modelValue"])]),s("div",D,[i(p,{filled:"",modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=a=>e.password=a),type:"password",id:"registration-password",label:"Password"},null,8,["modelValue"])]),K,s("div",M,[i(p,{filled:"",modelValue:e.passwordCopy,"onUpdate:modelValue":o[2]||(o[2]=a=>e.passwordCopy=a),type:"password",id:"registration-password",label:"Re-type Password"},null,8,["modelValue"])])]),O,i(b,{outline:"",color:"white",class:"email-register-btn",label:"Email-Password Registration",type:"submit"}),W,i(b,{onClick:e.googleRegister,outline:"",color:"white",class:"google-register-btn",label:"Register with Gmail Account"},null,8,["onClick"])],32),e.error?(h(),w("div",Y,U(e.error.message)+" 1234",1)):x("",!0)])]),_:1})]),_:1})])}var q=k($,[["render",j],["__scopeId","data-v-78ea3ef6"]]);export{q as default};
